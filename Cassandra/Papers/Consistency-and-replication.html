<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_ttu3l796dpmu-3>li:before{content:"\0025cf  "}.lst-kix_ttu3l796dpmu-4>li:before{content:"\0025cb  "}.lst-kix_ttu3l796dpmu-2>li:before{content:"\0025a0  "}.lst-kix_ttu3l796dpmu-6>li:before{content:"\0025cf  "}.lst-kix_ttu3l796dpmu-0>li:before{content:"\0025cf  "}.lst-kix_ttu3l796dpmu-7>li:before{content:"\0025cb  "}.lst-kix_ttu3l796dpmu-8>li:before{content:"\0025a0  "}.lst-kix_scyh679lsok-7>li:before{content:"\0025cb  "}.lst-kix_scyh679lsok-8>li:before{content:"\0025a0  "}.lst-kix_ttu3l796dpmu-1>li:before{content:"\0025cb  "}ul.lst-kix_ttu3l796dpmu-3{list-style-type:none}ul.lst-kix_ttu3l796dpmu-4{list-style-type:none}ul.lst-kix_ttu3l796dpmu-5{list-style-type:none}ul.lst-kix_ttu3l796dpmu-6{list-style-type:none}ul.lst-kix_ttu3l796dpmu-0{list-style-type:none}.lst-kix_ttu3l796dpmu-5>li:before{content:"\0025a0  "}ul.lst-kix_ttu3l796dpmu-1{list-style-type:none}ul.lst-kix_ttu3l796dpmu-2{list-style-type:none}ul.lst-kix_ttu3l796dpmu-7{list-style-type:none}ul.lst-kix_ttu3l796dpmu-8{list-style-type:none}.lst-kix_scyh679lsok-1>li:before{content:"\0025cb  "}.lst-kix_scyh679lsok-0>li:before{content:"\0025cf  "}.lst-kix_scyh679lsok-5>li:before{content:"\0025a0  "}.lst-kix_scyh679lsok-6>li:before{content:"\0025cf  "}.lst-kix_scyh679lsok-2>li:before{content:"\0025a0  "}.lst-kix_scyh679lsok-3>li:before{content:"\0025cf  "}.lst-kix_scyh679lsok-4>li:before{content:"\0025cb  "}.lst-kix_12dozgymga4f-6>li:before{content:"\0025cf  "}ul.lst-kix_12dozgymga4f-2{list-style-type:none}ul.lst-kix_12dozgymga4f-3{list-style-type:none}ul.lst-kix_12dozgymga4f-0{list-style-type:none}ul.lst-kix_12dozgymga4f-1{list-style-type:none}ul.lst-kix_12dozgymga4f-6{list-style-type:none}.lst-kix_12dozgymga4f-7>li:before{content:"\0025cb  "}ul.lst-kix_12dozgymga4f-7{list-style-type:none}ul.lst-kix_12dozgymga4f-4{list-style-type:none}.lst-kix_12dozgymga4f-8>li:before{content:"\0025a0  "}ul.lst-kix_12dozgymga4f-5{list-style-type:none}.lst-kix_12dozgymga4f-0>li:before{content:"\0025cf  "}ul.lst-kix_12dozgymga4f-8{list-style-type:none}.lst-kix_12dozgymga4f-5>li:before{content:"\0025a0  "}ul.lst-kix_scyh679lsok-7{list-style-type:none}.lst-kix_12dozgymga4f-3>li:before{content:"\0025cf  "}ul.lst-kix_scyh679lsok-8{list-style-type:none}ul.lst-kix_scyh679lsok-5{list-style-type:none}.lst-kix_12dozgymga4f-4>li:before{content:"\0025cb  "}ul.lst-kix_scyh679lsok-6{list-style-type:none}ul.lst-kix_scyh679lsok-3{list-style-type:none}ul.lst-kix_scyh679lsok-4{list-style-type:none}ul.lst-kix_scyh679lsok-1{list-style-type:none}ul.lst-kix_scyh679lsok-2{list-style-type:none}.lst-kix_12dozgymga4f-1>li:before{content:"\0025cb  "}ul.lst-kix_scyh679lsok-0{list-style-type:none}.lst-kix_12dozgymga4f-2>li:before{content:"\0025a0  "}ol{margin:0;padding:0}table td,table th{padding:0}.c2{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#000000;border-left-style:solid;border-bottom-width:1pt;width:66.8pt;border-top-color:#000000;border-bottom-style:solid}.c22{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#000000;border-left-style:solid;border-bottom-width:1pt;width:153.8pt;border-top-color:#000000;border-bottom-style:solid}.c19{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#000000;border-left-style:solid;border-bottom-width:1pt;width:71.2pt;border-top-color:#000000;border-bottom-style:solid}.c33{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:96pt;border-top-color:#000000;border-bottom-style:solid}.c10{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:123.8pt;border-top-color:#000000;border-bottom-style:solid}.c21{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:66.8pt;border-top-color:#000000;border-bottom-style:solid}.c43{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:71.2pt;border-top-color:#000000;border-bottom-style:solid}.c24{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:119.2pt;border-top-color:#000000;border-bottom-style:solid}.c11{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:143.2pt;border-top-color:#000000;border-bottom-style:solid}.c0{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:165.8pt;border-top-color:#000000;border-bottom-style:solid}.c37{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:125.2pt;border-top-color:#000000;border-bottom-style:solid}.c39{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:100.5pt;border-top-color:#000000;border-bottom-style:solid}.c28{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:37.5pt;border-top-color:#000000;border-bottom-style:solid}.c25{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:111.8pt;border-top-color:#000000;border-bottom-style:solid}.c46{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:153.8pt;border-top-color:#000000;border-bottom-style:solid}.c31{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:98.2pt;border-top-color:#000000;border-bottom-style:solid}.c42{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:95.2pt;border-top-color:#000000;border-bottom-style:solid}.c14{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:189.8pt;border-top-color:#000000;border-bottom-style:solid}.c13{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:324.8pt;border-top-color:#000000;border-bottom-style:solid}.c16{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:162.8pt;border-top-color:#000000;border-bottom-style:solid}.c30{color:#cc0000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c15{color:#ffffff;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c34{color:#cc0000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c44{color:#6aa84f;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c27{background-color:#ffffff;vertical-align:super;font-size:14pt;font-style:italic;color:#0b0080}.c8{background-color:#ffffff;font-size:10.5pt;font-style:italic;color:#252525;font-weight:700}.c6{padding-top:10pt;line-height:1.0;orphans:2;widows:2}.c26{background-color:#ffffff;font-size:10.5pt;font-style:italic;color:#0b0080}.c52{margin-left:54pt;padding-top:3pt;padding-left:0pt;padding-bottom:1pt}.c5{margin-left:36pt;orphans:2;widows:2;padding-left:0pt}.c41{border-spacing:0;border-collapse:collapse;margin-right:auto}.c35{background-color:#ffffff;font-size:10.5pt;font-style:italic;color:#252525}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c20{margin-left:18pt;padding-top:3pt;line-height:1.0}.c53{background-color:#ffffff;font-size:10.5pt;color:#252525}.c45{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c38{margin-left:36pt;padding-top:3pt;line-height:1.0}.c32{padding-top:6pt;padding-bottom:6pt}.c40{padding:0;margin:0}.c4{color:inherit;text-decoration:inherit}.c47{padding-top:4pt;line-height:1.0}.c12{orphans:2;widows:2}.c9{color:#1155cc;text-decoration:underline}.c50{padding-bottom:4pt}.c48{font-style:italic}.c17{page-break-after:avoid}.c29{font-weight:700}.c49{height:14pt}.c23{height:20pt}.c51{height:16pt}.c18{height:11pt}.c7{height:0pt}.c36{background-color:#000000}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c45"><p class="c12 c17 title" id="h.3s8w54cn8fl0"><span>Cassandra: Consistency &amp; replication</span></p><p class="c12 c17 subtitle" id="h.b10uj8x3i4dw"><span>Chris Hoolihan (</span><span class="c9"><a class="c4" href="mailto:chrusty@gmail.com">chrusty@gmail.com</a></span><span>)</span></p><h1 class="c12 c17" id="h.ceiu7039ns6o"><span>Contents</span></h1><p class="c12 c47"><span class="c9"><a class="c4" href="#h.ceiu7039ns6o">Contents</a></span></p><p class="c6"><span class="c9"><a class="c4" href="#h.iem1asirv4tg">Introduction</a></span></p><p class="c6"><span class="c9"><a class="c4" href="#h.qdqaxsqzwtup">CAP Theorem</a></span></p><p class="c20 c12"><span class="c9"><a class="c4" href="#h.rbxbxj458s5z">In general</a></span></p><p class="c20 c12"><span class="c9"><a class="c4" href="#h.zgg70hw4h1vt">With Cassandra</a></span></p><p class="c12 c38"><span class="c9"><a class="c4" href="#h.fk5q6jgh6rln">Replication-strategies</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.fkk30molu3l0">Consistency-level</a></span></p><p class="c6"><span class="c9"><a class="c4" href="#h.xxo7pc1lowdi">Coping with failure</a></span></p><p class="c20 c12"><span class="c9"><a class="c4" href="#h.ta18vfkaxpte">Redundancy</a></span></p><p class="c20 c12"><span class="c9"><a class="c4" href="#h.q1q10mk8hwu6">Consistency</a></span></p><p class="c6"><span class="c9"><a class="c4" href="#h.mug05ptqd3et">CAP Requirements</a></span></p><p class="c12 c20"><span class="c9"><a class="c4" href="#h.b6o5g96n8twi">Consistency &amp; Availability (CA)</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.wiz0chlb3n7">Single DC</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.jwm7m0qlot9x">Multi DC</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.aov1w2ik145x">The bottom line</a></span></p><p class="c20 c12"><span class="c9"><a class="c4" href="#h.tf336m7ul0o0">Consistency &amp; Partition-tolerance (CP)</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.ggobg42i79ff">Single DC</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.larchk8tnmjc">Multi DC</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.9qomm0jozkj5">The bottom line</a></span></p><p class="c20 c12"><span class="c9"><a class="c4" href="#h.1q1op6zfuce0">Availability &amp; Partition-tolerance (AP)</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.pk2k0a24znok">Single DC</a></span></p><p class="c38 c12"><span class="c9"><a class="c4" href="#h.o0vrwi66an7k">Multi DC</a></span></p><p class="c38 c12 c50"><span class="c9"><a class="c4" href="#h.ngd2ad7bgwmv">The bottom line</a></span></p><h1 class="c12 c17" id="h.iem1asirv4tg"><span>Introduction</span></h1><p class="c12"><span>This document is intended to provide an explanation of how replication works together with Cassandra&rsquo;s consistency-levels, allowing you to select the right balance between consistency, performance and availability.</span></p><p class="c12 c18"><span></span></p><p class="c12"><span>As the concepts discussed relate directly to CAP Theorem, that is a natural place to start.</span></p><h1 class="c12 c17" id="h.qdqaxsqzwtup"><span>CAP Theorem</span></h1><p class="c12"><span>CAP Theorem is a concise way of defining the problems that people hosting a distributed database (like Cassandra) have to navigate. Without an appreciation for this it will be very difficult to provide/support suitable data solutions based on Cassandra.</span></p><h2 class="c12 c17" id="h.rbxbxj458s5z"><span>In general</span></h2><p class="c12"><span>From WikiPedia: &ldquo;</span><span class="c9 c48"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/CAP_theorem&amp;sa=D&amp;ust=1476784116704000&amp;usg=AFQjCNGMBbLlUzExfVflFEAKPfba9P8Slg">CAP Theorem</a></span><span class="c48">&nbsp;(</span><span class="c35">also named </span><span class="c8">Brewer&#39;s theorem</span><span class="c35">&nbsp;after computer scientist </span><span class="c26"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Eric_Brewer_(scientist)&amp;sa=D&amp;ust=1476784116705000&amp;usg=AFQjCNFhsZWe6v2FGsCDHPLtPLKQtYt9QA">Eric Brewer</a></span><span class="c35">) states that it is impossible for a </span><span class="c26"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Distributed_computing&amp;sa=D&amp;ust=1476784116706000&amp;usg=AFQjCNHFK1zEnWPl65LsUcMAgPYsN25dRw">distributed computer system</a></span><span class="c35">&nbsp;to simultaneously provide all three of the following guarantees:</span><span class="c27"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/CAP_theorem%23cite_note-Gilbert_Lynch-1&amp;sa=D&amp;ust=1476784116707000&amp;usg=AFQjCNFcF8uZnpBbfCVjcO-Z53UtkYKvIg">[1]</a></span><span class="c27"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/CAP_theorem%23cite_note-2&amp;sa=D&amp;ust=1476784116707000&amp;usg=AFQjCNF2b81TCEBZ2uopBZLiLUic3mMKdQ">[2]</a></span><span class="c27"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/CAP_theorem%23cite_note-3&amp;sa=D&amp;ust=1476784116707000&amp;usg=AFQjCNHB_yuX77YcMRzxeoydUF44K3XFtw">[3]</a></span></p><ul class="c40 lst-kix_scyh679lsok-0 start"><li class="c52 c12"><span class="c26"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Consistency_(database_systems)&amp;sa=D&amp;ust=1476784116708000&amp;usg=AFQjCNGYnUXZkbhf2J6hk99_P-2rORGS5w">Consistency</a></span><span class="c35">&nbsp;(every read receives the most recent write or an error)</span></li><li class="c12 c52"><span class="c26"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Availability&amp;sa=D&amp;ust=1476784116709000&amp;usg=AFQjCNERctVrcYOyS9gVC3eQqVG0DeEznQ">Availability</a></span><span class="c35">&nbsp;(every request receives a response, without guarantee that it contains the most recent version of the information)</span></li><li class="c52 c12"><span class="c26"><a class="c4" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Network_partitioning&amp;sa=D&amp;ust=1476784116710000&amp;usg=AFQjCNFtr76mjPhUNZ2QUHJI-sY7c6MHlQ">Partition tolerance</a></span><span class="c35">&nbsp;(the system continues to operate despite arbitrary partitioning due to network failures)</span></li></ul><p class="c32 c12"><span class="c8">In other words, the CAP theorem states that in the presence of a network partition, one has to choose between consistency and availability</span><span class="c35">.&rdquo;</span></p><h2 class="c32 c12 c17" id="h.zgg70hw4h1vt"><span>With Cassandra</span></h2><p class="c12 c32"><span class="c53">Fortunately for us, Cassandra provides ways to work with combinations of these CAP requirements by working with consistency-levels and replication-strategies.</span></p><h3 class="c32 c12 c17" id="h.fk5q6jgh6rln"><span>Replication-strategies</span></h3><p class="c12"><span class="c9"><a class="c4" href="https://www.google.com/url?q=https://docs.datastax.com/en/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html&amp;sa=D&amp;ust=1476784116712000&amp;usg=AFQjCNESmgrcXNFRDEVtcftUaJ7vmRNO3Q">Cassandra allows users to define how many copies of their data will be stored in the cluster</a></span><span>, and where they will be placed (using &ldquo;rack&rdquo; and &ldquo;data-centre&rdquo; aware topologies such as &ldquo;NetworkTopologyStrategy&rdquo;). Having more than one copy of the data is what allows Cassandra to be highly-available. Having more than one copy of the data also invites inconsistency under certain circumstances.</span></p><h3 class="c32 c12 c17" id="h.fkk30molu3l0"><span>Consistency-level</span></h3><p class="c12"><span class="c9"><a class="c4" href="https://www.google.com/url?q=http://docs.datastax.com/en/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html&amp;sa=D&amp;ust=1476784116712000&amp;usg=AFQjCNHfBY4uYTmluQVIVrqnSl6zdvlxcA">Cassandra allows users to select the consistency requirements</a></span><span>&nbsp;each time they perform a query. This essentially tells Cassandra how many of the replicas of the queries data are involved to perform the query.</span></p><hr style="page-break-before:always;display:none;"><h1 class="c12 c17 c23" id="h.ndeomix5s2mi"><span></span></h1><h1 class="c12 c17" id="h.xxo7pc1lowdi"><span>Coping with failure</span></h1><p class="c12"><span>Despite how virtualised we consider our environments to be and however expensive the equipment hosting it is, failure should not be considered as the exception to the rule - any well designed system should be able to keep running even when some of the individual components break (according to your appetite for outages). This becomes particularly important in a dynamic environment such as AWS, where no guarantees on the lifetime of an individual instance are made.</span></p><p class="c12 c18"><span></span></p><p class="c12"><span>Cassandra gives us two ways to deal with this: replication / redundancy, and tunable-consistency. We can choose to have so many copies of everything that it doesn&rsquo;t matter if some break, or we can choose to make a trade-off in terms of consistency and give out perhaps slightly out-of-date information in times of trouble.</span></p><h2 class="c12 c17" id="h.ta18vfkaxpte"><span>Redundancy</span></h2><p class="c12"><span>Although this is a tempting label for unreliable computers, in this case I am using this term to refer to parts of a system for which failure can be anticipated and worked with / mitigated against.</span></p><p class="c12 c18"><span></span></p><a id="t.536eeef57d92f048f92cf15633337c40032418ac"></a><a id="t.0"></a><table class="c41"><tbody><tr class="c7"><td class="c37 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Failure Unit</span></p></td><td class="c13 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Mitigation</span></p></td></tr><tr class="c7"><td class="c37" colspan="1" rowspan="1"><p class="c1"><span class="c3">A disk drive</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c1"><span class="c3">Use RAID or mirroring</span></p></td></tr><tr class="c7"><td class="c37" colspan="1" rowspan="1"><p class="c1"><span class="c3">A Cassandra &ldquo;node&rdquo;</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c1"><span class="c3">Have multiple replicas on different nodes</span></p></td></tr><tr class="c7"><td class="c37" colspan="1" rowspan="1"><p class="c1"><span class="c3">A rack full of nodes</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c1"><span class="c3">Have enough racks per DC to use LOCAL_QUORUM</span></p></td></tr><tr class="c7"><td class="c37" colspan="1" rowspan="1"><p class="c1"><span class="c3">A data-centre of racks</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c1"><span class="c3">Have enough DCs to use QUORUM</span></p></td></tr></tbody></table><h2 class="c12 c17" id="h.q1q10mk8hwu6"><span>Consistency</span></h2><p class="c12"><span>The full-redundancy route carries a considerable amount of overhead when we start considering hosting 3 data-centres each with at least 3 nodes in them. The alternative is to give up on consistency a little bit.</span></p><p class="c12 c18"><span></span></p><p class="c12"><span>If your application can handle it then you could at first attempt strong-consistency (global) queries, and if they were to fail then fall-back to lower consistency (local) levels.</span></p><hr style="page-break-before:always;display:none;"><h1 class="c12 c17 c23" id="h.gg02f6dqh506"><span></span></h1><h1 class="c12 c17" id="h.mug05ptqd3et"><span>CAP Requirements</span></h1><p class="c12"><span>The following sections explain how to achieve useful combinations within the CAP Theorem requirements of Consistency, Availability, and Partition-tolerance.</span></p><h2 class="c12 c17" id="h.b6o5g96n8twi"><span>Consistency &amp; Availability (CA)</span></h2><p class="c12"><span>The requirement for both consistency and availability can be achieved by having enough copies of the data to allow queries to work against the majority of them at any one time. This is known as &ldquo;quorum&rdquo; or &ldquo;consensus&rdquo;. If more than half of the replicas are involved, then it is impossible to get the incorrect result. The penalty for involving multiple replicas however is that queries will of course require more resources and will take more time to complete.</span></p><h3 class="c12 c17" id="h.wiz0chlb3n7"><span>Single DC</span></h3><p class="c12"><span>In a single data-centre Cassandra cluster it is possible to have both strong consistency AND high availability by making use of the </span><span class="c29">QUORUM</span><span>&nbsp;consistency level. Quorum queries require more than half of the replicas to respond.</span></p><p class="c12 c18"><span></span></p><a id="t.024876c5388022e19b908613a90a6e6465e7bfe2"></a><a id="t.1"></a><table class="c41"><tbody><tr class="c7"><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c15">Replicas</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c1"><span class="c15">Quorum</span></p></td><td class="c16 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Acceptable Failed Replicas</span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c15">C/A Tolerant?</span></p></td></tr><tr class="c7"><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">1</span></p></td><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">1</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">0</span></p></td><td class="c46" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">0</span></p></td><td class="c46" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">1</span></p></td><td class="c46" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr><tr class="c7"><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">4</span></p></td><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">1</span></p></td><td class="c46" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr><tr class="c7"><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">5</span></p></td><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">2</span></p></td><td class="c46" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr><tr class="c7"><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">6</span></p></td><td class="c21" colspan="1" rowspan="1"><p class="c1"><span class="c3">4</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">2</span></p></td><td class="c46" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr></tbody></table><p class="c12 c18"><span></span></p><p class="c12"><span>This table indicates that the minimum number of replicas required to provide a C/A combination is 3 (which allows queries to be served even when one of the replicas is offline). Choosing 4 replicas still only allows 1 replica to be offline, so 5 is the minimum replication-factor which allows more than 1 replica to be offline while still guaranteeing consistency. Of course, maintaining 5 replicas is quite an overhead in terms of performance and cost. </span><span>This is why most people running small-scale clusters choose to use 3 replicas.</span></p><hr style="page-break-before:always;display:none;"><h3 class="c12 c17 c49" id="h.4qqt7dv2vqkc"><span></span></h3><h3 class="c12 c17" id="h.jwm7m0qlot9x"><span>Multi DC</span></h3><p class="c12"><span>In a multi data-centre Cassandra cluster it is also possible to achieve a CA combination, but this requires EVERY query to involve remote replicas. This approach should not be taken lightly, as it means that every query will be at least as slow as the WAN-link round-trip. Remember that in this scenario there are more points of failure: previously it was just the number of nodes, but now we have entire data-centres which can go offline (and given the nature of WAN links this should be considered the rule rather than the exception).</span></p><p class="c12 c18"><span></span></p><a id="t.a8b27aa3c36455e4efa3f1ba0d0e931e7ae865c7"></a><a id="t.2"></a><table class="c41"><tbody><tr class="c7"><td class="c39 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Replicas per DC</span></p></td><td class="c28 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">DCs</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c15">Quorum</span></p></td><td class="c31 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">DCs involved</span></p></td><td class="c11 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">C/A Tolerant?</span></p></td></tr><tr class="c7"><td class="c39" colspan="1" rowspan="1"><p class="c1"><span class="c3">1</span></p></td><td class="c28" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">2/2</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c39" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c28" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c29 c34">2/2</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c39" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c28" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c1"><span class="c3">4</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">2/2</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c39" colspan="1" rowspan="1"><p class="c1"><span class="c3">1</span></p></td><td class="c28" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">2/3</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr><tr class="c7"><td class="c39" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c28" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c1"><span class="c3">4</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">2/3</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr><tr class="c7"><td class="c39" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c28" colspan="1" rowspan="1"><p class="c1"><span class="c3">3</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c1"><span class="c3">5</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c29 c44">2/3</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr></tbody></table><p class="c12 c18"><span></span></p><p class="c12"><span>This table indicates that the minimum number of data-centres required to achieve a multi-DC CA combination is 3. While this IS possible with only one replica at each DC, this is really only a theoretical minimum. In practise most people would choose to have at least 3 replicas per data-centre, because this provides solutions for other types of CAP combinations (mentioned later in this document).</span></p><h3 class="c12 c17" id="h.aov1w2ik145x"><span>The bottom line</span></h3><p class="c12"><span class="c29">To achieve CA you need to use QUORUM queries and have a minimum of 3 replicas.</span></p><hr style="page-break-before:always;display:none;"><h2 class="c12 c17 c51" id="h.tj14zaun3hb3"><span></span></h2><h2 class="c12 c17" id="h.tf336m7ul0o0"><span>Consistency &amp; Partition-tolerance (CP)</span></h2><p class="c12"><span>The requirement for both consistency and partition-tolerance can not be achieved for an entire cluster, ever. This would effectively be stating that all nodes of the cluster should be able to respond with the correct results even if some of them are unable to communicate with the rest. Until we have quantum teleportation this will always be a problem, so until that point we need to design our systems a little differently.</span></p><h3 class="c12 c17" id="h.ggobg42i79ff"><span>Single DC</span></h3><p class="c12"><span>In a single DC you can overcome network partitioning by applying retries and timeouts to the CA approach outlined above. Simply put, if a </span><span class="c29">QUORUM</span><span>&nbsp;query happens to land in a part of the network which doesn&rsquo;t have enough nodes to serve it then it will fail. In this situation the application simply needs to retry on another node.</span></p><p class="c12 c18"><span></span></p><p class="c12"><span class="c29">For this reason I strongly recommend hosting Cassandra clusters in 3 racks per DC.</span><span>&nbsp;Rack-aware Cassandra will distributed replicas between as many racks as possible, as racks are considered to be another unit of failure.</span></p><h3 class="c12 c17" id="h.larchk8tnmjc"><span>Multi DC</span></h3><p class="c12"><span>In a multi DC cluster the same rules apply, although a client configured to only talk to &ldquo;DC-local&rdquo; Cassandra instances will not be able to execute QUORUM queries if all other DCs are unavailable.</span></p><h3 class="c12 c17" id="h.9qomm0jozkj5"><span>The bottom line</span></h3><p class="c12"><span>Short of diverting traffic to healthy datacentres, there is not much else that can be done for &ldquo;cut-off&rdquo; partitioned sections of a Cassandra cluster if consistency is important.</span></p><p class="c12 c18"><span></span></p><p class="c12"><span class="c29">There is still a way to guarantee availability however, and this is the subject of the third and final CAP combination.</span></p><hr style="page-break-before:always;display:none;"><h2 class="c12 c17 c51" id="h.ozbfk71fdurn"><span></span></h2><h2 class="c12 c17" id="h.1q1op6zfuce0"><span>Availability &amp; Partition-tolerance (AP)</span></h2><p class="c12"><span>In light of the shortcomings of the CP approach, AP requirements are a little easier to work with. We have so far only dealt with STRONG consensus-based consistency models, where the focus was on the &ldquo;C&rdquo;. While Cassandra can handle those modes, taking consistency out of the requirement (or at least reducing it somewhat) makes the job even easier.</span></p><p class="c12 c18"><span></span></p><p class="c12"><span>You have probably heard Cassandra being described as &ldquo;eventually consistent&rdquo; (this is what happens if you don&rsquo;t make use of the stronger consistency-levels). The following scenarios rely on this eventual consistency to asynchronously replicate the data between the partition-prone segments, while still allowing optionally high consistency levels within local areas or &ldquo;failure units&rdquo;.</span></p><h3 class="c12 c17" id="h.pk2k0a24znok"><span>Single DC</span></h3><p class="c12"><span>For a single DC cluster to retain AP characteristics, the only consistency-level you could use would be &ldquo;</span><span class="c29">ONE</span><span>&rdquo;. This means that only one replica needs to respond before a query can successfully return. It is still of course good practise to have more than one replica.</span></p><p class="c12 c18"><span></span></p><a id="t.c924f5c89cf1d0035763fe19fb50281b048120a7"></a><a id="t.3"></a><table class="c41"><tbody><tr class="c7"><td class="c42 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Replicas</span></p></td><td class="c0 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Acceptable Failed Replicas</span></p></td><td class="c14 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">AP Tolerant?</span></p></td></tr><tr class="c7"><td class="c42" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">1</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c1"><span class="c3">0</span></p></td><td class="c14" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c42" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">2</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c1"><span class="c3">1</span></p></td><td class="c14" colspan="1" rowspan="1"><p class="c1"><span>y</span><span class="c3">es</span></p></td></tr><tr class="c7"><td class="c42" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">3</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c1"><span class="c3">2</span></p></td><td class="c14" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr></tbody></table><p class="c12 c18"><span></span></p><p class="c12"><span>This table indicates that it is possible to achieve AP tolerance with only 2 replicas at consistency-level </span><span class="c29">ONE</span><span>, demonstrating that if you can ease back your consistency requirements then you don&rsquo;t have to maintain so many copies of your data just to achieve consensus.</span></p><h3 class="c12 c17 c49" id="h.9hb4hjvbu14n"><span></span></h3><hr style="page-break-before:always;display:none;"><h3 class="c12 c17 c49" id="h.l3xumf6vnc5a"><span></span></h3><h3 class="c12 c17" id="h.o0vrwi66an7k"><span>Multi DC</span></h3><p class="c12"><span>Multi DC Cassandra clusters allow some special scenarios, which when combined with the right application can provide both partition-tolerance (for the WAN connection) but strong-consistency at a local level. This involves having enough replicas at each site to use the </span><span class="c29">LOCAL_QUORUM</span><span>&nbsp;consistency level, where only replicas at the local DC are involved in queries. If you are able to consistently shard your traffic (say on geographical boundaries) then under normal operations you wouldn&rsquo;t require global QUORUM queries, but you still have the ability to re-route that traffic between DCs and know that all but the last fraction of a percent of recently written data will be in place.</span></p><p class="c12 c18"><span></span></p><a id="t.b489cce0440edc3ab202ed11ecf7feba04516a03"></a><a id="t.4"></a><table class="c41"><tbody><tr class="c7"><td class="c33 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Replicas per DC</span></p></td><td class="c25 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Consistency-level</span></p></td><td class="c24 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">AP Tolerant (WAN)?</span></p></td><td class="c10 c36" colspan="1" rowspan="1"><p class="c1"><span class="c15">Local Consistency?</span></p></td></tr><tr class="c7"><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">1</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c30">ONE / LOCAL_ONE</span></p></td><td class="c24" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">1</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c30">LOCAL_QUORUM</span></p></td><td class="c24" colspan="1" rowspan="1"><p class="c1"><span class="c3">n/a</span></p></td><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c3">n/a</span></p></td></tr><tr class="c7"><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">2</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c30">ONE / LOCAL_ONE</span></p></td><td class="c24" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">2</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c30">LOCAL_QUORUM</span></p></td><td class="c24" colspan="1" rowspan="1"><p class="c1"><span class="c3">n/a</span></p></td><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c3">n/a</span></p></td></tr><tr class="c7"><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c34 c29">3</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c30">ONE / LOCAL_ONE</span></p></td><td class="c24" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c3">no</span></p></td></tr><tr class="c7"><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">3</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c44 c29">LOCAL_QUORUM</span></p></td><td class="c24" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c3">yes</span></p></td></tr></tbody></table><p class="c12 c18"><span></span></p><h3 class="c12 c17" id="h.ngd2ad7bgwmv"><span>The bottom line</span></h3><p class="c12"><span class="c29">To achieve both high-availability and partition-tolerance you will need to sacrifice consistency.</span></p><p class="c12 c18"><span></span></p><p class="c12"><span>AP systems would generally make use of the following consistency-levels:</span></p><ul class="c40 lst-kix_12dozgymga4f-0 start"><li class="c5"><span>ONE</span></li><li class="c5"><span>LOCAL_ONE</span></li><li class="c5"><span>LOCAL_QUORUM</span></li></ul></body></html>